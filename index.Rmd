---
title: "Gov 50 Final Project"
author: Makayla Gathers
description: "Gov 50 Final"
output:
  distill::distill_article:
    self_contained: false
---


## Project thoughts

I am interested in exploring data related to the education system and criminal justice. 

Research Question: Are places with private prisons more likely to have adverse opinions on Critical Race Theory?

Proposal: I will be analyzing the relationship between the presence of private prisons and people's views on Critical Race Theory in school systems. We often discuss the school to prison pipeline, understanding statistics like Black males who aren't reading at their grade level by 2nd grade, are almost guaranteed to fall victim to the prison system. With the recent attacks not just on education, but also on critical race theory, I am curious to see if there is any correlation between not just where private prisons are owned and how much incarceration occurs, but also will these numbers reflect the states/ares with a population who have adverse opinions on the teaching of slavery, the civil war, and other topics. 

I will be using two data sets, that are both loaded into R. One is a data set describing the presence of private prisons throughout the last 30 years, their location, and the amount of persons incarcerated in them. The other data set is a survey with measuring wokeness, including a question about critical race theory. 

The variables analyzed will be the state and the design capacity of the prisons, analyzing how many each state has, and the variables of the other set will be the state and level of support. 

The outcome that will be analyzed is the amount of support in areas with more prisons and areas with higher capacity prisons. 

I think I will find that the areas with the most prisons and with higher cpacity prisons will result in less support for criitcal race theory, and I am interested in seeing if areas with more capacity will have less support than areas with more prisons. 

```{r}
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)


criticalrt <- read_csv("~/Documents/crt.csv")
facility <- read_csv("~/Documents/facilitydatabase.csv") 


critical <- criticalrt |>
select(BGC5_4, ppstaten) |>
na.omit() |>
rename(support = BGC5_4)

critical0 <- critical |>
group_by(ppstaten) |>
  summarize(n = mean(support)) |>
  mutate(prop_support = n / sum(n))
 
critical0 |> ggplot(aes(x = ppstaten, y = n)) +
  geom_col()



yearelect <- facility|>
filter(year == 2016) |>
select(state, designcapacity) |>
group_by(state) |>
mutate(dc = mean(designcapacity)) |>
summarise(sums = mean(dc)) |>
mutate(prop_capacity = sums/ sum(sums))




yearelect |> ggplot(aes(x = state, y = sums)) +
  geom_col()

both <- cbind(critical0,yearelect) |>
  select(-state)

```
```{r}
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)

ggplot(both, mapping = aes(x = prop_support,
                     y = prop_capacity)) +
  geom_point(mapping = aes(color = ppstaten)) +
  geom_smooth(color = "black") 
```

```{r}
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(broom)
library(infer)

fit_both <- lm(prop_capacity ~ prop_support, data = both)
tidy(fit_both) |> knitr::kable(digits = 3)
fit_both

summary(fit_both) 

modelsummary::modelsummary(fit_both,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))
```






